{"ast":null,"code":"import _regeneratorRuntime from\"@babel/runtime/regenerator\";import _classCallCheck from\"@babel/runtime/helpers/classCallCheck\";import _createClass from\"@babel/runtime/helpers/createClass\";import _possibleConstructorReturn from\"@babel/runtime/helpers/possibleConstructorReturn\";import _getPrototypeOf from\"@babel/runtime/helpers/getPrototypeOf\";import _inherits from\"@babel/runtime/helpers/inherits\";import React,{useState}from'react';import Text from\"react-native-web/dist/exports/Text\";import View from\"react-native-web/dist/exports/View\";import StyleSheet from\"react-native-web/dist/exports/StyleSheet\";import Button from\"react-native-web/dist/exports/Button\";import Alert from\"react-native-web/dist/exports/Alert\";import Dimensions from\"react-native-web/dist/exports/Dimensions\";import{Camera}from'expo-camera';import*as Permissions from'expo-permissions';import{db}from\"./constants/ApiKeys\";import{Ionicons}from'@expo/vector-icons';var Scanner=function(_React$Component){_inherits(Scanner,_React$Component);function Scanner(){var _this;_classCallCheck(this,Scanner);_this=_possibleConstructorReturn(this,_getPrototypeOf(Scanner).call(this));_this.state={hasCameraPermission:null,isScanned:false,flash:'off',icon:'ios-flash-off'};_this.handleBarCodeScanned=function(_ref){var type=_ref.type,data=_ref.data;_this.setState({isScanned:true});if(data!==''&&data!==null){db.ref(\"codigos/\"+data).on('value',function(snapshot){if(snapshot.exists()&&snapshot.val()!==null){code=snapshot.val().codigo;Alert.alert('Found',\"Bar code: \"+data+\" \\nCode: \"+code,[{text:'OK',onPress:function onPress(){return _this.setState({isScanned:false});}}]);}else{Alert.alert('Not Found',\"Bar code: \"+data+\"\\nCode: Not Found\",[{text:'OK',onPress:function onPress(){return _this.setState({isScanned:false});}}]);}});}};_this._handleFlash=function(){var _this$state=_this.state,flash=_this$state.flash,icon=_this$state.icon;if(flash==='torch'){_this.setState({flash:'off'});_this.setState({icon:\"ios-flash-off\"});}else{_this.setState({flash:'torch'});_this.setState({icon:\"ios-flash\"});}};_this.state={hasCameraPermission:null,isScanned:false,flash:'off',icon:'ios-flash-off'};return _this;}_createClass(Scanner,[{key:\"componentDidMount\",value:function componentDidMount(){var _await$Permissions$as,status;return _regeneratorRuntime.async(function componentDidMount$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return _regeneratorRuntime.awrap(Permissions.askAsync(Permissions.CAMERA));case 2:_await$Permissions$as=_context.sent;status=_await$Permissions$as.status;this.setState({hasCameraPermission:status===\"granted\"?true:false});case 5:case\"end\":return _context.stop();}}},null,this);}},{key:\"render\",value:function render(){var _this2=this;var _this$state2=this.state,hasCameraPermission=_this$state2.hasCameraPermission,isScanned=_this$state2.isScanned,icon=_this$state2.icon,flash=_this$state2.flash;if(hasCameraPermission===null){return React.createElement(Text,null,\"Requesting for camera permission\");}else if(hasCameraPermission===false){return React.createElement(Text,null,\"No access to camera\");}else if(hasCameraPermission===true){return React.createElement(View,{style:{flex:1,flexDirection:'column',justifyContent:'flex-end'}},React.createElement(Camera,{onBarCodeScanned:isScanned?undefined:this.handleBarCodeScanned,style:[StyleSheet.absoluteFillObject,styles.container],flashMode:flash},React.createElement(Text,{style:styles.description},\"Scan Barcode\"),React.createElement(Ionicons,{name:icon,color:\"white\",size:27,onPress:this._handleFlash,style:{paddingTop:'10%',textAlign:'center',backgroundColor:opacity}}),React.createElement(View,{style:styles.layerTop}),React.createElement(View,{style:styles.layerCenter},React.createElement(View,{style:styles.layerLeft}),React.createElement(View,{style:styles.focused}),React.createElement(View,{style:styles.layerRight})),React.createElement(View,{style:styles.layerBottom},React.createElement(Text,{onPress:function onPress(){return _this2.props.navigation.goBack();},style:styles.cancel},\"Cancel\"))));}}}]);return Scanner;}(React.Component);Scanner.navigationOptions={headerShown:false};export{Scanner as default};var _Dimensions$get=Dimensions.get('window'),width=_Dimensions$get.width;var opacity='rgba(0, 0, 0, .5)';var styles=StyleSheet.create({container:{flex:1,flexDirection:'column'},layerTop:{flex:1,backgroundColor:opacity},layerCenter:{flex:2,flexDirection:'row'},layerLeft:{flex:1,backgroundColor:opacity},focused:{flex:13},layerRight:{flex:1,backgroundColor:opacity},layerBottom:{flex:3,backgroundColor:opacity},description:{fontSize:width*0.09,paddingTop:'25%',textAlign:'center',color:'white',backgroundColor:opacity},cancel:{fontSize:width*0.05,textAlign:'center',color:'white',marginTop:'20%'}});","map":{"version":3,"sources":["C:/Users/Duarte/react-native-navigation/src/Scanner.js"],"names":["React","useState","Camera","Permissions","db","Ionicons","Scanner","state","hasCameraPermission","isScanned","flash","icon","handleBarCodeScanned","type","data","setState","ref","on","snapshot","exists","val","code","codigo","Alert","alert","text","onPress","_handleFlash","askAsync","CAMERA","status","flex","flexDirection","justifyContent","undefined","StyleSheet","absoluteFillObject","styles","container","description","paddingTop","textAlign","backgroundColor","opacity","layerTop","layerCenter","layerLeft","focused","layerRight","layerBottom","props","navigation","goBack","cancel","Component","navigationOptions","headerShown","Dimensions","get","width","create","fontSize","color","marginTop"],"mappings":"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","sourcesContent":["import React, {useState} from 'react';\r\nimport { Text, View, StyleSheet, Button, Alert, Dimensions } from 'react-native';\r\nimport { Camera } from 'expo-camera';\r\nimport * as Permissions from 'expo-permissions';\r\nimport { db } from './constants/ApiKeys';\r\nimport { Ionicons } from '@expo/vector-icons'; \r\n\r\nexport default class Scanner extends React.Component {\r\n  constructor(){\r\n    super();\r\n    this.state = {\r\n      hasCameraPermission: null, // if app has permissions to acess camera\r\n      isScanned: false, // scanned\r\n      flash: 'off',\r\n      icon: 'ios-flash-off'\r\n    };\r\n  }\r\n  static navigationOptions = {\r\n    headerShown: false,\r\n  }\r\n  \r\n  state = {\r\n    hasCameraPermission: null, // if app has permissions to acess camera\r\n    isScanned: false, // scanned\r\n    flash: 'off',\r\n    icon: 'ios-flash-off'\r\n  }\r\n\r\n  async componentDidMount() {\r\n    const { status } = await Permissions.askAsync(Permissions.CAMERA);\r\n    this.setState({ hasCameraPermission: status === \"granted\" ? true : false });\r\n  }\r\n  \r\n  handleBarCodeScanned = ({ type, data }) => {\r\n    this.setState({isScanned: true});\r\n    if (data !== '' && data !== null) {\r\n      db.ref(`codigos/${data}`).on('value', (snapshot) => {\r\n        if (snapshot.exists() && snapshot.val() !== null) {\r\n          code = snapshot.val().codigo;\r\n          Alert.alert('Found', `Bar code: ${data} \\nCode: ${code}`,[{ text: 'OK', onPress: () => this.setState({isScanned: false}) }]);\r\n        }\r\n        else {\r\n          Alert.alert('Not Found', `Bar code: ${data}\\nCode: Not Found`,[{ text: 'OK', onPress: () => this.setState({isScanned: false}) }]);\r\n        }\r\n      });\r\n    }\r\n }\r\n\r\n  _handleFlash = () => {\r\n    const { flash, icon } = this.state;\r\n    if (flash === 'torch') {\r\n        this.setState({ flash: 'off' });\r\n        this.setState({icon: \"ios-flash-off\"});\r\n    } else {\r\n        this.setState({ flash: 'torch' });\r\n        this.setState({icon: \"ios-flash\"});\r\n    }\r\n}\r\n\r\nrender() {\r\n    const { hasCameraPermission, isScanned, icon, flash } = this.state;\r\n    if(hasCameraPermission === null){\r\n      return (\r\n        <Text>Requesting for camera permission</Text> \r\n      );\r\n    }\r\n    else if(hasCameraPermission === false){\r\n      return ( \r\n        <Text>No access to camera</Text>\r\n      )\r\n    }\r\n    else if(hasCameraPermission === true){\r\n      return(\r\n    <View\r\n      style={{\r\n        flex: 1,\r\n        flexDirection: 'column',\r\n        justifyContent: 'flex-end',\r\n      }}>\r\n        <Camera\r\n        onBarCodeScanned={ isScanned ? undefined : this.handleBarCodeScanned}\r\n        style={[StyleSheet.absoluteFillObject, styles.container]}\r\n        flashMode={flash}\r\n        >\r\n        <Text style={styles.description}>Scan Barcode</Text>\r\n        <Ionicons name={icon} color='white' size={27} onPress={this._handleFlash} style={{paddingTop: '10%',textAlign: 'center',backgroundColor: opacity}}>\r\n        </Ionicons>\r\n        <View style={styles.layerTop} />\r\n        <View style={styles.layerCenter}>\r\n          <View style={styles.layerLeft} />\r\n          <View style={styles.focused} />\r\n          <View style={styles.layerRight} />\r\n        </View>\r\n        <View style={styles.layerBottom}>\r\n        <Text\r\n          onPress={() => this.props.navigation.goBack() }\r\n          style={styles.cancel}>\r\n          Cancel\r\n        </Text>\r\n        </View>\r\n      </Camera>\r\n    </View>\r\n  );\r\n}\r\n}\r\n}\r\nconst { width } = Dimensions.get('window')\r\nconst opacity = 'rgba(0, 0, 0, .5)';\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    flex: 1,\r\n    flexDirection: 'column',\r\n  },\r\n  layerTop: {\r\n    flex: 1,\r\n    backgroundColor: opacity\r\n  },\r\n  layerCenter: {\r\n    flex: 2,\r\n    flexDirection: 'row'\r\n  },\r\n  layerLeft: {\r\n    flex: 1,\r\n    backgroundColor: opacity\r\n  },\r\n  focused: {\r\n    flex: 13\r\n  },\r\n  layerRight: {\r\n    flex: 1,\r\n    backgroundColor: opacity\r\n  },\r\n  layerBottom: {\r\n    flex: 3,\r\n    backgroundColor: opacity\r\n  },\r\n  description: {\r\n    fontSize: width * 0.09,\r\n    paddingTop: '25%',\r\n    textAlign: 'center',\r\n    color: 'white',\r\n    backgroundColor: opacity\r\n  },\r\n  cancel: {\r\n    fontSize: width * 0.05,\r\n    textAlign: 'center',\r\n    color: 'white',\r\n    marginTop: '20%',\r\n  }\r\n});"]},"metadata":{},"sourceType":"module"}